{% macro backtest_params() %}
<div class="card mt-4">
    <div class="card-header d-flex align-items-center">
        <i class="bi bi-graph-up-arrow me-2"></i>
        <h5 class="mb-0">Backtest Parameters</h5>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <label for="initial_portfolio_size" class="form-label">Initial Portfolio Size ($)</label>
            <input type="number" class="form-control" id="initial_portfolio_size" value="10000" min="100" max="1000000" step="100">
        </div>
        
        <div class="mb-3">
            <label for="stop_loss_pct" class="form-label">Stop Loss (%)</label>
            <input type="number" class="form-control" id="stop_loss_pct" value="2" min="0.1" max="20" step="0.1">
        </div>
        
        <div class="mb-3">
            <label for="take_profit_pct" class="form-label">Take Profit (%)</label>
            <input type="number" class="form-control" id="take_profit_pct" value="4" min="0.1" max="20" step="0.1">
        </div>
        
        <div class="mb-3">
            <label for="entry_delay" class="form-label">Entry Delay (candles)</label>
            <input type="number" class="form-control" id="entry_delay" value="1" min="0" max="10" step="1">
        </div>
        
        <div class="mb-3">
            <label for="max_holding_periods" class="form-label">Max Holding Periods</label>
            <input type="number" class="form-control" id="max_holding_periods" value="20" min="1" max="100" step="1">
        </div>
        
        <button type="button" class="btn btn-primary w-100" id="runBacktest">
            <i class="bi bi-play-fill me-2"></i>Run Backtest
        </button>
    </div>
</div>

<div class="card mt-4 d-none" id="backtestResults">
    <div class="card-header d-flex align-items-center">
        <i class="bi bi-bar-chart-fill me-2"></i>
        <h5 class="mb-0">Backtest Results</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <div class="mb-3">
                    <label class="form-label">Total Trades</label>
                    <p class="h4" id="totalTrades">-</p>
                </div>
                <div class="mb-3">
                    <label class="form-label">Win Rate</label>
                    <p class="h4" id="winRate">-</p>
                </div>
                <div class="mb-3">
                    <label class="form-label">Profit Factor</label>
                    <p class="h4" id="profitFactor">-</p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="mb-3">
                    <label class="form-label">Average Profit</label>
                    <p class="h4" id="averageProfit">-</p>
                </div>
                <div class="mb-3">
                    <label class="form-label">Total Profit</label>
                    <p class="h4" id="totalProfit">-</p>
                </div>
                <div class="mb-3">
                    <label class="form-label">Final Portfolio Value</label>
                    <p class="h4" id="finalPortfolioValue">-</p>
                </div>
            </div>
        </div>
        
        <!-- Portfolio Chart Button and Container -->
        <div class="mt-4 mb-4">
            <button type="button" class="btn btn-outline-primary mb-3" id="showPortfolioChart">
                <i class="bi bi-graph-up me-2"></i>Show Portfolio Chart
            </button>
            <div id="portfolioChartContainer" class="d-none">
                <h5>Portfolio Value Over Time</h5>
                <canvas id="portfolioChart" height="200"></canvas>
            </div>
        </div>
        
        <div class="table-responsive mt-4">
            <table class="table table-striped" id="tradesTable">
                <thead>
                    <tr>
                        <th>Entry Date</th>
                        <th>Exit Date</th>
                        <th>Entry Price</th>
                        <th>Exit Price</th>
                        <th>Profit %</th>
                        <th>Periods</th>
                        <th>Exit Reason</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>
{% endmacro %} 